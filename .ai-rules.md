# AI Assistant Rules for Frame Forge Project

## Project Overview
Frame Forge is a Flutter package that provides a DSL (Domain Specific Language) for creating dynamic UI layouts with a visual editor. The package supports cross-platform file operations and WASM compatibility.

## Core Principles

### 1. Architecture Guidelines
- **Universal Services**: Use conditional imports for platform-specific functionality
- **Controller Pattern**: Business logic should be in controllers, not widgets
- **Event-Driven**: Use event bus for communication between components
- **Cross-Platform**: Ensure compatibility with mobile, desktop, and web platforms

### 2. Code

- dont use 'translate'. Use translateByVector3, translateByVector4, or translateByDouble instead.
- dont use 'groupValue'. Use a RadioGroup ancestor to manage group value instead

### 3. Code Quality
- **Static Analysis**: Always run `dart analyze` and fix all issues before commits
- **Linting**: Follow Flutter lints and maintain clean code
- **Documentation**: Update README.md in both English and Russian
- **Versioning**: Follow semantic versioning (major.minor.patch)

### 4. Dependencies Management
- **Minimal Dependencies**: Keep dependencies to minimum required
- **Cross-Platform**: Prefer packages that support all target platforms
- **Version Constraints**: Use compatible version ranges
- **Pub.dev Compliance**: Ensure all dependencies are pub.dev compatible

## Development Workflow

### 1. Before Making Changes
```bash
# Check current status
dart analyze
flutter test
dart pub deps --style=list
```

### 2. File Structure Rules
- Controllers go in `lib/src/layout_model/controller/`
- Platform services go in `lib/src/layout_model/controller/file_picker/`
- UI widgets follow existing naming patterns
- Use proper imports with relative paths

### 3. Testing Strategy
- Test cross-platform functionality
- Verify WASM compatibility on web
- Check static analysis passes
- Validate example app works

### 4. Documentation Updates
- Update `CHANGELOG.md` with all changes
- Maintain both `README.md` (English) and `README.ru.md` (Russian)
- Include code examples for new features
- Update version in `pubspec.yaml`

## Common Issues and Solutions

### File Picker Implementation
- ❌ Don't use `dart:html` directly
- ✅ Use conditional imports with factory pattern
- ✅ Handle null returns gracefully
- ✅ Implement proper error handling

### Controller Integration
- ❌ Don't put business logic in widgets
- ✅ Use LayoutModelController methods
- ✅ Follow event-driven architecture
- ✅ Update property notifiers properly

### Platform Compatibility
- ❌ Don't assume specific platform APIs available
- ✅ Use conditional compilation
- ✅ Test on web, mobile, and desktop
- ✅ Handle platform-specific limitations

## Git Workflow

### 1. Branch Management
- Main branch: `main`
- Feature branches: `feature/description`
- Hotfix branches: `hotfix/description`

### 2. Commit Messages
- Use conventional commit format
- Include scope: `feat(controller): add file picker support`
- Reference issues when applicable

### 3. Before Publishing
```bash
# Prepare for publication
dart analyze
flutter test
dart pub publish --dry-run
```

## Package Publication

### 1. Version Updates
- Update `pubspec.yaml` version
- Update `CHANGELOG.md` with new version
- Tag release in git: `git tag v1.0.0`

### 2. Pub.dev Requirements
- Clean static analysis (no errors/warnings)
- Complete documentation
- Example application works
- Cross-platform compatibility verified

## Emergency Procedures

### 1. Breaking Changes
- Increment major version
- Document migration path
- Provide deprecation warnings when possible

### 2. Critical Bugs
- Create hotfix branch
- Minimal changes only
- Fast-track testing and publication

## Notes for Future AI Assistants

### Context Preservation
- Always check git status and recent commits
- Review recent file changes before modifications
- Understand the current development state

### Problem-Solving Approach
1. Identify the root cause
2. Check existing patterns in codebase
3. Implement consistent with architecture
4. Test cross-platform compatibility
5. Update documentation

### Communication Style
- Be concise but thorough
- Explain architectural decisions
- Provide code examples
- Mention testing implications

---

